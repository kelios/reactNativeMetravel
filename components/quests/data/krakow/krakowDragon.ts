// data/krakow/krakowDragon.ts
import type { QuestStep, QuestFinale } from '@/components/quests/QuestWizard';

const normalize = (s: string) =>
    s.toLowerCase()
        .replace(/\s+/g, ' ')
        .replace(/[.,;:!?'‚Äû‚Äù"‚Äì‚Äî-]/g, '')
        .replace('—ë', '–µ')
        .trim();

// util to avoid bundler crash if asset missing
function tryImage<T>(fn: () => T): T | null {
    try { return fn(); } catch { return null as any; }
}

const IMG1 = tryImage(() => require('@/assets/quests/krakowDragon/1.png'));
const IMG2 = tryImage(() => require('@/assets/quests/krakowDragon/2.png'));
const IMG3 = tryImage(() => require('@/assets/quests/krakowDragon/3.png'));
const IMG4 = tryImage(() => require('@/assets/quests/krakowDragon/4.png'));
const IMG5 = tryImage(() => require('@/assets/quests/krakowDragon/5.png'));
const IMG6 = tryImage(() => require('@/assets/quests/krakowDragon/6.png'));
const IMG7 = tryImage(() => require('@/assets/quests/krakowDragon/7.png'));
const VIDEO = (() => { try { return require('@/assets/quests/krakowDragon/krakowDragon.mp4'); } catch { return null; } })();

export const KRAKOW_DRAGON_INTRO: QuestStep = {
    id: 'intro',
    title: '–ö–∞–∫ –ø—Ä–æ–π—Ç–∏ –∫–≤–µ—Å—Ç?',
    location: '–ù–∞—á–∞–ª–æ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è',
    story: `–≠—Ç–æ—Ç –∫–≤–µ—Å—Ç ‚Äî –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –ø–æ –ö—Ä–∞–∫–æ–≤—É, –≥–¥–µ –æ–∂–∏–≤–∞–µ—Ç –ª–µ–≥–µ–Ω–¥–∞ –æ –í–∞–≤–µ–ª—å—Å–∫–æ–º –¥—Ä–∞–∫–æ–Ω–µ.

‚ö° –ß—Ç–æ –¥–µ–ª–∞—Ç—å:
1) –ü—Ä–æ—á–∏—Ç–∞–π –ª–µ–≥–µ–Ω–¥—É –∏ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏.
2) –ù–∞–π–¥–∏ –º–µ—Å—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–µ.
3) –û—Å–º–æ—Ç—Ä–∏—Å—å –∏ –≤—ã–ø–æ–ª–Ω–∏ –∑–∞–¥–∞–Ω–∏–µ.
4) –í–≤–µ–¥–∏ –æ—Ç–≤–µ—Ç ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥.

üé≠ –ü–æ–¥—Å–∫–∞–∑–∫–∏: –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –Ω–æ –Ω–µ –≤—ã–¥–∞—é—Ç –æ—Ç–≤–µ—Ç.

üêâ –§–∏–Ω–∞–ª: –ø–æ—Å–ª–µ –≤—Å–µ—Ö –∏—Å–ø—ã—Ç–∞–Ω–∏–π ‚Äî –≤—Å—Ç—Ä–µ—á–∞ —Å –¥—Ä–∞–∫–æ–Ω–æ–º!`,
    task: '–ù–∞–∂–º–∏ ¬´–ù–∞—á–∞—Ç—å –∫–≤–µ—Å—Ç¬ª, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å—Å—è –≤ –ø—É—Ç—å.',
    hint: undefined,
    answer: () => true,
    lat: 0, lng: 0, mapsUrl: '', image: null,
};

export const KRAKOW_DRAGON_STEPS: QuestStep[] = [
    {
        id: '1-rynek',
        title: '–†—ã–Ω–æ—á–Ω–∞—è –ø–ª–æ—â–∞–¥—å ‚Äî –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ –ª–µ–≥–µ–Ω–¥—ã',
        location: 'Rynek G≈Ç√≥wny',
        story: '–°–µ—Ä–¥—Ü–µ –ö—Ä–∞–∫–æ–≤–∞ –±—å—ë—Ç—Å—è –∑–¥–µ—Å—å. –£ –ø–æ–¥–Ω–æ–∂–∏—è ¬´Eros Bendato¬ª —à–µ–ø—á—É—Ç –æ —á—É–¥–æ–≤–∏—â–µ, —á—Ç–æ –∂–∏–ª –ø–æ–¥ –í–∞–≤–µ–ª–µ–º. –ï—Å–ª–∏ –∑–∞–º–µ—Ç–∏–ª –≥–æ–ª–æ–≤—É ‚Äî —Å–º–æ—Ç—Ä–∏ –Ω–∞ –µ—ë —Å—Ç–æ—Ä–æ–Ω—É: —Ç–∞–º –ø–µ—Ä–≤—ã–π —Å–ª–µ–¥. –≠—Ö–æ –º–µ–ª–æ–¥–∏–∏ —Ç—Ä—É–±–∞—á–∞ –Ω–∞–ø—Ä–∞–≤–∏—Ç –¥–∞–ª—å—à–µ ‚Äî –∫ –ú–∞—Ä–∏–∞—Ü–∫–æ–º—É –∫–æ—Å—Ç—ë–ª—É.',
        task: '–ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ –°—É–∫–æ–Ω–Ω—ã–µ —Ä—è–¥—ã –Ω–∞–ø—Ä–æ—Ç–∏–≤ ¬´Eros Bendato¬ª. –°—á–∏—Ç–∞–π –æ–∫–Ω–∞ –Ω–∞–¥ –∞—Ä–∫–∞–¥–∞–º–∏ —Ç–æ–ª—å–∫–æ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã, –≥–¥–µ —Å—Ç–æ–∏—Ç –≥–æ–ª–æ–≤–∞. –°–∫–æ–ª—å–∫–æ –∏—Ö?',
        hint: '–°–º–æ—Ç—Ä–∏ –Ω–∞ ¬´—Å–≤–æ—é¬ª –ø–æ–ª–æ–≤–∏–Ω—É —Ä—è–¥–æ–≤ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –≥–æ–ª–æ–≤—ã. –û–∫–Ω–∞ –∏–¥—É—Ç –ø–æ–¥—Ä—è–¥, –≤—ã—Å–æ–∫–æ.',
        answer: s => { const n = parseInt(s,10); return !Number.isNaN(n) && n >= 21 && n <= 23; },
        lat: 50.061697, lng: 19.937117,
        mapsUrl: 'https://maps.google.com/?q=Rynek%20G%C5%82%C3%B3wny%20Krak%C3%B3w',
        image: IMG1,
    },
    {
        id: '2-mariacki',
        title: '–ú–∞—Ä–∏–∞—Ü–∫–∏–π –∫–æ—Å—Ç—ë–ª ‚Äî –æ–±–æ—Ä–≤–∞–Ω–Ω–∞—è –º–µ–ª–æ–¥–∏—è',
        location: 'Bazylika Mariacka',
        story: '–¢—Ä—É–±–∞—á –∫–∞–∂–¥—ã–π —á–∞—Å –ø–æ–¥–Ω–∏–º–∞–ª —Ç—Ä–µ–≤–æ–≥—É, –Ω–æ —Å—Ç—Ä–µ–ª–∞ –ø—Ä–µ—Ä–≤–∞–ª–∞ –µ–≥–æ –ø–µ—Å–Ω—å. –° —Ç–µ—Ö –ø–æ—Ä –º–µ–ª–æ–¥–∏—è –≤—Å–µ–≥–¥–∞ –æ–±—Ä—ã–≤–∞–µ—Ç—Å—è ‚Äî –∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è —Å–Ω–æ–≤–∞ –∏ —Å–Ω–æ–≤–∞. –û—Ç–∑–≤—É–∫–∏ –ø—Ä–∏–≤–µ–¥—É—Ç —Ç–µ–±—è –∫ –ø–µ—á–∞—Ç–∏ –≥–æ—Ä–æ–¥–∞ –≤ –°—É–∫–æ–Ω–Ω—ã—Ö —Ä—è–¥–∞—Ö.',
        task: '–°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –æ–Ω —Å–ª—ã—à–µ–Ω –≤ —Ç–µ—á–µ–Ω–∏–µ —Å—É—Ç–æ–∫?',
        hint: '–ü–æ–¥—É–º–∞–π –æ —Ç–æ–º, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —Å–º–µ–Ω—è–µ—Ç—Å—è —á–∞—Å–æ–≤–∞—è —Å—Ç—Ä–µ–ª–∫–∞.',
        answer: s => parseInt(s,10) === 24,
        lat: 50.061721, lng: 19.939094,
        mapsUrl: 'https://maps.google.com/?q=St%20Mary%27s%20Basilica%20Krakow',
        image: IMG2,
    },
    {
        id: '3-sukiennice',
        title: '–°—É–∫–æ–Ω–Ω—ã–µ —Ä—è–¥—ã ‚Äî –ø–µ—á–∞—Ç—å –≥–æ—Ä–æ–¥–∞',
        location: 'Sukiennice',
        story: '–ù–∞ —Ñ–∞—Å–∞–¥–∞—Ö –∏ –≤–Ω—É—Ç—Ä–∏ —Ä—è–¥–æ–≤ ‚Äî –≥–µ—Ä–±-–ø–µ—á–∞—Ç—å, —á—Ç–æ –≤–µ–∫–∞–º–∏ –æ–±–µ—Ä–µ–≥–∞–ª–∞ –≥–æ—Ä–æ–¥ –æ—Ç –±–µ–¥. –í –µ—ë –±–∞—à–Ω—è—Ö –∑–∞–∫–ª—é—á–µ–Ω–∞ —Å–∏–ª–∞. –¢—Ä–∏ —Å—Ç—Ä–∞–∂–∞ —É–∫–∞–∂—É—Ç –ø—É—Ç—å –∫ —Å–µ–≤–µ—Ä–Ω–æ–π –≥—Ä–∞–Ω–∏—Ü–µ ‚Äî –∫ –§–ª–æ—Ä–∏–∞–Ω—Å–∫–∏–º –≤–æ—Ä–æ—Ç–∞–º.',
        task: '–°–∫–æ–ª—å–∫–æ –±–∞—à–µ–Ω –Ω–∞ –≥–µ—Ä–±–µ –≥–æ—Ä–æ–¥–∞? –í–≤–µ–¥–∏ —á–∏—Å–ª–æ.',
        hint: '–ì–µ—Ä–± –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω–µ —Ç–æ–ª—å–∫–æ —Å–Ω–∞—Ä—É–∂–∏ ‚Äî –ø—Ä–æ–π–¥–∏—Å—å –≤–Ω—É—Ç—Ä–∏ –≤–¥–æ–ª—å —Ä—è–¥–æ–≤ –∏ –ø—Ä–∏—Å–º–æ—Ç—Ä–∏—Å—å –∫ —ç–º–±–ª–µ–º–∞–º.',
        answer: s => parseInt(s,10) === 3,
        lat: 50.061667, lng: 19.937373,
        mapsUrl: 'https://maps.google.com/?q=Sukiennice%20Krakow',
        image: IMG3,
    },
    {
        id: '4-barbakan',
        title: '–§–ª–æ—Ä–∏–∞–Ω—Å–∫–∏–µ –≤–æ—Ä–æ—Ç–∞ ‚Äî —Å—Ç—Ä–∞–∂ –Ω–∞ —Ä—É–±–µ–∂–µ',
        location: '–§–ª–æ—Ä–∏–∞–Ω—Å–∫–∏–µ –≤–æ—Ä–æ—Ç–∞',
        story: '–°–µ–≤–µ—Ä–Ω—ã–π –≤—Ö–æ–¥ –≥–æ—Ä–æ–¥–∞ –æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ç–∏—Ü–∞ —Å–∏–ª—ã. –ï—ë –±–∞—Ä–µ–ª—å–µ—Ñ —Å–º–æ—Ç—Ä–∏—Ç –≤ —Å—Ç–æ—Ä–æ–Ω—É –ë–∞—Ä–±–∞–∫–∞ ‚Äî –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –ª–∏–Ω–∏—è—Ö –æ–±–æ—Ä–æ–Ω—ã. –ù–∞–π–¥—ë—à—å –µ—ë ‚Äî —Å–≤–µ—Ç –≤ –ö–∞–∑–∏–º–µ–∂e –ø–æ–¥—Å–∫–∞–∂–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —Å–ª–µ–¥.',
        task: '–ù–∞–π–¥–∏ –±–∞—Ä–µ–ª—å–µ—Ñ –Ω–∞–¥ –ø–æ—Ä—Ç–∞–ª–æ–º –§–ª–æ—Ä–∏–∞–Ω—Å–∫–∏—Ö –≤–æ—Ä–æ—Ç. –ö–∞–∫–∞—è –ø—Ç–∏—Ü–∞ –æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Ö–æ–¥ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –ë–∞—Ä–±–∞–∫–∞?',
        hint: '–ö—Ä—ã–ª—å—è —Ä–∞—Å–∫–∏–Ω—É—Ç—ã, –≤–∑–≥–ª—è–¥ —Å—Ç—Ä–æ–≥–∏–π ‚Äî —Å–∏–º–≤–æ–ª –≤–ª–∞—Å—Ç–∏ –∏ –∑–∞—â–∏—Ç—ã.',
        answer: s => normalize(s) === '–æ—Ä–µ–ª',
        lat: 50.06551229826169, lng: 19.941680331885227,
        mapsUrl: 'https://maps.google.com/?q=Florian%20Gate%20Krakow',
        image: IMG4,
    },
    {
        id: '5-kazimierz',
        title: '–ö–∞–∑–∏–º–µ–∂ ‚Äî –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–æ–∫ –≥–æ–ª–æ—Å–æ–≤',
        location: '–°—Ç–∞—Ä–∞—è —Å–∏–Ω–∞–≥–æ–≥–∞',
        story: '–í —ç—Ç–∏—Ö –∫–≤–∞—Ä—Ç–∞–ª–∞—Ö –ª–µ–≥–µ–Ω–¥—É —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–ª–∏ –ø–æ-—Ä–∞–∑–Ω–æ–º—É, –∏ –ø—Ä–∞–≤–¥—É –æ –¥—Ä–∞–∫–æ–Ω–µ –æ—Ç—Ä–∞–∂–∞–ª–∏ –Ω–æ—á–Ω—ã–µ –æ–≥–Ω–∏ –Ω–∞ —Ñ–∞—Å–∞–¥–∞—Ö. –°–≤–µ—Ç —É–∫–∞–∂–µ—Ç –ø—É—Ç—å –∫ –º–æ—Å—Ç—É –º–µ–∂–¥—É –Ω–µ–±–æ–º –∏ –∑–µ–º–ª—ë–π.',
        task: '–°–∫–æ–ª—å–∫–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å–≤–µ—Ç–∞ –æ—Å–≤–µ—â–∞—é—Ç —ç—Ç–æ—Ç —Ñ–∞—Å–∞–¥ –Ω–æ—á—å—é?',
        hint: '–°—á–∏—Ç–∞–π –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ —Å–≤–µ—Ç–∞, –∞ –Ω–µ –±–ª–∏–∫–∏.',
        answer: s => { const n = parseInt(s,10); return !Number.isNaN(n) && n >= 2 && n <= 4; },
        lat: 50.05152733785882, lng: 19.94864899181073,
        mapsUrl: 'https://maps.google.com/?q=Old%20Synagogue%20Krakow',
        image: IMG5,
    },
    {
        id: '6-wawel',
        title: '–ú–æ—Å—Ç –º–µ–∂–¥—É –Ω–µ–±–æ–º –∏ –∑–µ–º–ª—ë–π',
        location: '–ú–æ—Å—Ç (—Å–º. –∫–∞—Ä—Ç—É)',
        story: '–ì–æ–≤–æ—Ä—è—Ç, —ç—Ç–æ—Ç –º–æ—Å—Ç —Å–æ–µ–¥–∏–Ω—è–µ—Ç –∑–µ–º–Ω–æ–µ –∏ –Ω–µ–±–µ—Å–Ω–æ–µ. –î–∞–∂–µ –∑–¥–µ—Å—å —á—É–≤—Å—Ç–≤—É–µ—Ç—Å—è –¥—ã—Ö–∞–Ω–∏–µ –ª–µ–≥–µ–Ω–¥—ã ‚Äî —Å–º–æ—Ç—Ä–∏ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–µ–µ: –¥—Ä–∞–∫–æ–Ω—å–∏ –º–æ—Ç–∏–≤—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –ø—É—Ç—å –∫ –ª–æ–≥–æ–≤—É.',
        task: '–°–∫–æ–ª—å–∫–æ –¥—Ä–∞–∫–æ–Ω–æ–≤ –æ—Ö—Ä–∞–Ω—è—é—Ç –º–æ—Å—Ç?',
        hint: '–û—Å–º–æ—Ç—Ä–∏—Å—å –ø–æ —Ç–æ—Ä—Ü–∞–º –∏ –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–∞–º',
        answer: s => parseInt(s,10) === 1,
        lat: 50.046563, lng: 19.947499,
        mapsUrl: 'https://maps.google.com/?q=50.046563,19.947499',
        image: IMG6,
    },
    {
        id: '7-smocza-jama',
        title: 'Smocza Jama ‚Äî –ª–æ–≥–æ–≤–æ —á—É–¥–æ–≤–∏—â–∞',
        location: '–ü–µ—â–µ—Ä–∞ –¥—Ä–∞–∫–æ–Ω–∞',
        story: '–í–æ—Ç –æ–Ω–∞ ‚Äî Smocza Jama. –î–≤–∏–≥–∞–π—Å—è –∏–º–µ–Ω–Ω–æ –∫ –≤—Ö–æ–¥—É –≤ –ø–µ—â–µ—Ä—É: –∫–æ—Ä–æ—Ç–∫–∞—è –∫–∞–º–µ–Ω–Ω–∞—è –ª–µ—Å—Ç–Ω–∏—Ü–∞ –≤–µ–¥—ë—Ç –ø—Ä—è–º–æ –∫ –ø–æ—Ä–æ–≥—É.',
        task: '–î–æ–π–¥–∏ –¥–æ –≤—Ö–æ–¥–∞ –≤ –ø–µ—â–µ—Ä—É –∏ –ø–æ—Å—á–∏—Ç–∞–π —Å—Ç—É–ø–µ–Ω–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤–µ–¥—É—Ç –¥–æ –ø–æ—Ä–æ–≥–∞. –°–∫–æ–ª—å–∫–æ —Å—Ç—É–ø–µ–Ω–µ–π –¥–æ –ø–µ—â–µ—Ä—ã?',
        hint: '–°—á–∏—Ç–∞–π —Ç–æ–ª—å–∫–æ –¥–æ –≤—Ö–æ–¥–∞ (–≤–Ω—É—Ç—Ä–∏ –Ω–µ –Ω—É–∂–Ω–æ). –û—Ç–≤–µ—Ç ‚Äî –¥–≤—É–∑–Ω–∞—á–Ω–æ–µ —á–∏—Å–ª–æ.',
        answer: s => parseInt(s,10) === 12,
        lat: 50.05317524594176, lng: 19.93359915663944,
        mapsUrl: 'https://maps.google.com/?q=Smocza%20Jama%20Krakow',
        image: IMG7,
    },
];

export const KRAKOW_DRAGON_FINALE: QuestFinale = {
    text:   '–¢—ã –ø—Ä–æ—à—ë–ª –ø—É—Ç—å –ª–µ–≥–µ–Ω–¥—ã! –ü–æ–¥ —Ö–æ–ª–º–æ–º —Å–ø–∞–ª –¥—Ä–∞–∫–æ–Ω, –Ω–æ –µ–≥–æ –¥—É—Ö –Ω–µ –∏—Å—á–µ–∑. ' +
        '–û–Ω –∂–∏–≤—ë—Ç –≤ –∫–∞–∂–¥–æ–º –∫–∞–º–Ω–µ, –≤ —à—É–º–µ –í–∏—Å–ª—ã –∏ –≤ —Å–µ—Ä–¥—Ü–µ –ö—Ä–∞–∫–æ–≤–∞. ' +
        '–ü–æ–∫–∞ –∑–≤—É—á–∏—Ç –∏—Å—Ç–æ—Ä–∏—è ‚Äî –¥—Ä–∞–∫–æ–Ω –ø—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è –≤–Ω–æ–≤—å, –Ω–∞–ø–æ–º–∏–Ω–∞—è: —Å–∏–ª–∞ –≥–æ—Ä–æ–¥–∞ ‚Äî –≤ –µ–¥–∏–Ω—Å—Ç–≤–µ –µ–≥–æ –ª—é–¥–µ–π –∏ –≤ –∏—Ö –ø–∞–º—è—Ç–∏.',
    video: VIDEO,
};

// —É–¥–æ–±–Ω—ã–µ —Ä–µ—ç–∫—Å–ø–æ—Ä—Ç—ã, –µ—Å–ª–∏ –≥–¥–µ-—Ç–æ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è normalize/tryImage
export { normalize, tryImage };
